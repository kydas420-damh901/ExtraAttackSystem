ゲーム内のバニラの武器種分類 と メモ
Axe         片手
Clubs       片手
Swords      片手
Spears      片手    左手装備できない
Polearms    両手 
knifes      片手
Fists       両手    バニラモーションはUnarmed と共通
BattleAxes  両手 
GreatSwords 両手
Unarmed     両手    バニラモーションはFistと共通
Dual Axes   両手
Dual Knifes 両手
Sledges     両手    バニラは通常攻撃しかないがqtg割り当てる
Torch       片手

Shileds     片手    左手に shiled だけ
Axes + Shileds
Swords + Shileds
Clubs + Shileds
Torch + Sword or Axe or Club or Spear or Knife
Torch + Unarmed

Bows        両手
Cross Bows  両手
staff       両手


アニメーション割当暫定版
Axe             
Clubs       
Swords      
Spears          左手装備できない
Polearms     
knifes      
Fists           バニラモーションはUnarmed と共通
BattleAxes   
GreatSwords 
Unarmed         バニラモーションはFistと共通
Dual Axes   
Dual Knifes 
Sledges         バニラは通常攻撃しかないがqtg割り当てる
Torch       

Shileds + unarmed     
Axes + Shileds
Swords + Shileds
Clubs + Shileds

Torch + Sword or Axe or Club or Spear or Knife
Torch + Unarmed

Bows
CrossBows
staff 



キー（変更可能：デフォルトはQ T G）押下で カスタムアニメーションの攻撃ができる
判定・ダメージ・スタミナ消費 音の有無、VFXの有無 を yaml で設定可能 ※将来的にはsound VFX を差し替えられるように。現在は未実装

・本MODで用意するアニメーション（ assetbundle 内アニメーション）
武器種類別にACを用意する
animation timing などはコード内で設定
animation clip もすべて指定


・ユーザーも追加できるアニメーション
本MODで用意した 武器種類別のアニメーションもyamlファイル(例：BaseAnimation.yaml)で置き換えと設定可能
個別武器ごとにACを用意する
yamlファイルで animation timing、判定やダメージなど設定可能
animation clip は指定フォルダに入れて、yamlファイルで設定することで置き換え可能

AC Category
Axe             
Clubs       
Swords      
Spears          左手装備できない
Polearms     
knifes      
Fists           バニラモーションはUnarmed と共通
BattleAxes   
GreatSwords 
Unarmed         バニラモーションはFistと共通
Dual Axes   
Dual Knifes 
Sledges         バニラは通常攻撃しかないがqtg割り当てる
Torch       

Shileds + unarmed     
Axes + Shileds
Swords + Shileds
Clubs + Shileds

Torch + Sword or Axe or Club or Spear or Knife

× 置き換え Animation Clip 指定 装備している武器のトリガーとクリップがあっていないと再生されない
- Unarmed/Fists unarmed_kick
- Knives:       Knife JumpAttack
- BattleAxes    BattleAxeAltAttack
- Spears:       throw_spear
- Swords:       Sword-Attack-R4
- Axes:         Axe Secondary Attack
- GreatSwords   Greatsword Secondary Attack
- Polearms      Atgeir360Attack
他の武器種、個別武器も上記ルールに合わせて指定 
※現在は、QTGすべて装備している武器のセカンダリ攻撃を設定

トリガー名
axe_secondary
sword_secondary
mace_secondary
atgeir_secondary
battleaxe_secondary
knife_secondary
dual_knives_secondary
greatsword_secondary
dualaxes_secondary



1. 根本的な問題
YAMLファイルは正常に読み込まれていたが、ConvertDirectMappingsToAocTypesでconfig.AocTypes.Count: 0となっていた
カスタムアニメーションは実際には動作していたが、YAML設定値が反映されていない状態
2. 具体的な問題点
3. ログから判明した事実
起動時: ReplacementMapにデータが正しく設定されている
YAML保存: SaveWeaponTypesConfigで正常に書き込み
YAML読み込み: ファイルは存在し、内容も読み込まれている
デシリアライズ: config.Axes.Count: 0 で空になっている
🛠️ 修正内容
1. デバッグログの追加

// AnimationReplacementConfig.cs に追加
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: ConfigFolderPath: {ConfigFolderPath}");
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: WeaponTypesConfigFilePath: {WeaponTypesConfigFilePath}");
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: File exists: {File.Exists(WeaponTypesConfigFilePath)}");
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: YAML content length: {yaml.Length}");
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: YAML contains 'AocTypes:': {yaml.Contains("AocTypes:")}");
ExtraAttackPlugin.LogInfo("System", $"LoadWeaponTypesConfig: After deserialization:");
ExtraAttackPlugin.LogInfo("System", $"  - config.AocTypes is null: {weaponTypesConfig.AocTypes == null}");
ExtraAttackPlugin.LogInfo("System", $"  - config.AocTypes.Count: {weaponTypesConfig.AocTypes?.Count ?? -1}");
ExtraAttackPlugin.LogInfo("System", $"  - config.Axes is null: {weaponTypesConfig.Axes == null}");
ExtraAttackPlugin.LogInfo("System", $"  - config.Axes.Count: {weaponTypesConfig.Axes?.Count ?? -1}");

// 統一前: ea_secondary_Q, ea_secondary_T, ea_secondary_G
// 統一後: secondary_Q, secondary_T, secondary_G




## 解決策: Prefix で m_attackStamina を変更
スキルボーナスを活かすには、Prefix で基準値を変更してバニラ計算を続行:
csharp[HarmonyPatch(typeof(Attack), "GetAttackStamina")]
public static class Attack_GetAttackStamina_Prefix
{
    public static void Prefix(Attack __instance, Humanoid ___m_character)
    {
        if (___m_character is Player player && ExtraAttackUtils.IsPlayerInExtraAttack(player))
        {
            // YAMLから基準スタミナ値を取得
            float yamlBaseStamina = GetYAMLBaseStaminaCost(...);
            
            // m_attackStaminaを上書き
            __instance.m_attackStamina = yamlBaseStamina;
            
            // バニラの計算続行:
            // - 装備補正
            // - SEMan補正
            // - スキル補正 (-33%)
            // - HP補正
        }
    }
}

計算例
YAML設定: StaminaCost: 60（基準値）
スキルレベル計算最終コスト060 × 1.0 × (1 - 0.33×0.0)605060 × 1.0 × (1 - 0.33×0.5)50.110060 × 1.0 × (1 - 0.33×1.0)40.2
スキルレベルが高いほどスタミナ消費が減る = バニラと同じ仕様